@page "/"
@inject HttpClient Http

@switch (Mode)
{
    case IndexMode.Welcome:
        <button @onclick="() => Mode = IndexMode.SignUp">新規登録</button>
        <button @onclick="() => Mode = IndexMode.SignIn">ログイン</button>
        break;
    case IndexMode.SignIn:
        <button @onclick="() => Mode = IndexMode.Welcome">←</button>
        <label>
            ユーザー名: <input type="text" required @bind="UserName" />
        </label>
        <label>
            パスワード: <input type="Password" required @bind="Password" />
        </label>

        <button @onclick="SignIn">サインイン</button>
        break;
    case IndexMode.SignUp:
        <button @onclick="() => Mode = IndexMode.Welcome">←</button>
        <label>
            ユーザー名: <input type="text" required @bind="UserName" />
        </label>
        <label>
            パスワード: <input type="password" required @bind="Password" />
        </label>
        <label>
            パスワード(確認): <input type="password" required @bind="PasswordToConfirm" />
        </label>
        <label>
            <input type="checkbox" @bind="Confirmed" />
            <a href="#">利用規約</a>に同意する
        </label>

        <button disabled="@(!Confirmed)" @onclick="SignUp">登録する</button>
        break;
}

@code {

    public string UserName { get; set; } = "";

    public string Password { get; set; } = "";

    public string PasswordToConfirm { get; set; } = "";

    public bool Confirmed { get; set; }

    public IndexMode Mode { get; set; } = IndexMode.Welcome;


    public void SignIn()
    {
        throw new NotImplementedException();
    }

    public void SignUp()
    {
        Http.PostAsync("https://localhost:5001/api/signup", new StringContent(JsonConvert.SerializeObject(new {
            userName = UserName,
            password = Password,
        })));
    }

    public enum IndexMode
    {
        Welcome, SignUp, SignIn, Timeline
    }
}